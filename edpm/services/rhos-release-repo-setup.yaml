apiVersion: dataplane.openstack.org/v1beta1
kind: OpenStackDataPlaneService
metadata:
  name: rhos-release-repo-setup
spec:
  playbookContents: |
	- hosts: all
  	strategy: linear
  	tasks:
    	- name: rhos-release
      	become: true
      	ansible.builtin.shell: |
        	set -euxo pipefail
        	sudo dnf install -y http://download.eng.bos.redhat.com/rcm-guest/puddles/OpenStack/rhos-release/rhos-release-latest.noarch.rpm
        	sudo rhos-release 18.0
    	- name: registry-proxy.engineering.redhat.com
      	become: true
      	ansible.builtin.shell: |
        	set -euxo pipefail
             mkdir -p /etc/containers/registries.conf.d
        	cat > /etc/containers/registries.conf.d/990-registry-proxy.engineering.redhat.com.conf << EOF
        	[[registry]]
        	location = "registry-proxy.engineering.redhat.com"
        	insecure = true
        	EOF